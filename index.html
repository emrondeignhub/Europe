<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <title>Europe map with country names</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <!-- Leaflet CSS -->
  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"
        integrity="sha256-sA+e2Yp7k2kz2tq7u0gYh0w+Jm3wH2i9f7vC2w5m0m4=" crossorigin=""/>

  <style>
    html,body,#map { height:100%; margin:0; padding:0; }
    /* Label styling */
    .country-label {
      font-family: "Segoe UI", Roboto, Arial, sans-serif;
      font-size: 12px;
      font-weight: 600;
      background: rgba(255,255,255,0.85);
      border-radius: 3px;
      padding: 2px 6px;
      box-shadow: 0 1px 2px rgba(0,0,0,0.15);
      color: #111;
      border: 1px solid rgba(0,0,0,0.08);
      white-space: nowrap;
      pointer-events: none;
    }

    /* Make the label text a bit smaller on very small screens */
    @media (max-width: 480px) {
      .country-label { font-size: 10px; padding: 1px 4px; }
    }
  </style>
</head>
<body>
  <div id="map"></div>

  <!-- Leaflet JS -->
  <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"
          integrity="sha256-o9N1j7g9mGq8d2Q6lq6qRk2s6uYw7zj1r3m4h4g0Xv0=" crossorigin=""></script>

  <script>
    // URL of a GeoJSON that contains Europe country polygons
    // (public repo: map-of-europe). If you prefer another source, replace this URL.
    const GEOJSON_URL = 'https://raw.githubusercontent.com/leakyMirror/map-of-europe/master/GeoJSON/europe.geojson';

    // create the map
    const map = L.map('map', {
      zoomControl: true,
      minZoom: 3,
      maxZoom: 10
    }).setView([54, 15], 4); // centered over Europe

    // OpenStreetMap baselayer
    L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
      attribution: 'Â© OpenStreetMap contributors'
    }).addTo(map);

    // Helper: get a label string from feature properties (tries several common keys)
    function getCountryName(props) {
      if (!props) return '';
      return props.NAME || props.NAME_EN || props.name || props.name_en || props.admin || props.sov_a3 || props.NAME_LONG || props.name_long || '';
    }

    // Style for polygons
    function styleFeature(feature) {
      return {
        color: '#2b6cb0',      // border color
        weight: 1,
        opacity: 0.6,
        fillColor: '#90cdf4',
        fillOpacity: 0.35
      };
    }

    // Load GeoJSON and add labels
    fetch(GEOJSON_URL)
      .then(resp => {
        if (!resp.ok) throw new Error('Failed to load GeoJSON: ' + resp.status);
        return resp.json();
      })
      .then(geojson => {
        // Add polygons
        L.geoJSON(geojson, {
          style: styleFeature,
          onEachFeature: function(feature, layer) {
            // Compute a centroid / center for label placement
            // Use layer.getBounds().getCenter() which works for polygons
            const bounds = layer.getBounds();
            const center = bounds.isValid() ? bounds.getCenter() : layer.getLatLng ? layer.getLatLng() : null;

            // Determine label text (fallbacks included)
            const labelText = getCountryName(feature.properties) || 'Unknown';

            if (center) {
              // Create a permanent tooltip as a label
              const tooltip = L.tooltip({
                permanent: true,
                direction: 'center',
                className: 'country-label',
                interactive: false,
                offset: [0, 0]
              })
              .setContent(labelText)
              .setLatLng(center)
              .addTo(map);

              // Optional: hide labels at high zoom out to avoid clutter
              function updateLabelVisibility() {
                // show labels when zoom >= 4; tweak threshold as you like
                if (map.getZoom() >= 4) {
                  tooltip.getElement()?.style.setProperty('display', '');
                } else {
                  tooltip.getElement()?.style.setProperty('display', 'none');
                }
              }
              map.on('zoomend', updateLabelVisibility);
              updateLabelVisibility();
            }

            // optional: show a popup when polygon is clicked with more properties
            layer.on('click', function() {
              const lines = [];
              const name = getCountryName(feature.properties);
              if (name) lines.push('<b>' + name + '</b>');
              if (feature.properties && Object.keys(feature.properties).length) {
                // show a couple of useful properties if present
                if (feature.properties.ISO_A3) lines.push('ISO3: ' + feature.properties.ISO_A3);
                if (feature.properties.ISO_A2) lines.push('ISO2: ' + feature.properties.ISO_A2);
                if (feature.properties.ADMIN) lines.push('Admin: ' + feature.properties.ADMIN);
              }
              layer.bindPopup(lines.join('<br>')).openPopup();
            });
          }
        }).addTo(map);
      })
      .catch(err => {
        console.error(err);
        alert('Could not load Europe GeoJSON. Check the GEOJSON_URL or your network console.');
      });
  </script>
</body>
</html>
